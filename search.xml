<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>Cocoa é›†åˆç±»å‹ï¼šNSPointerArrayï¼ŒNSMapTableï¼ŒNSHashTable</title>
    <url>/2017/08/24/Cocoa%E9%9B%86%E5%90%88%E7%B1%BB%E5%9E%8B%EF%BC%9ANSPointerArra%E3%80%81NSMapTable%E3%80%81NSHashTable/</url>
    <content><![CDATA[<!-- toc -->

<p>åœ¨iOS6ä¹‹åæ–°å¢äº†NSPointerArrayï¼ŒNSMapTableï¼ŒNSHashTableä¸‰ç§é›†åˆï¼Œåˆ†åˆ«æ‹“å±•äº†NSArrayã€NSDictionaryã€NSSetçš„åŠŸèƒ½ã€‚</p>
<a id="more"></a> 

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;&#x2F; NSPointerArrayï¼ŒNSMapTableï¼ŒNSHashTable</span><br><span class="line">API_AVAILABLE(macos(10.5), ios(6.0), watchos(2.0), tvos(9.0))</span><br></pre></td></tr></table></figure>

<p>ä¼ ç»Ÿé›†åˆç±»å‹çš„çŸ­æ¿ï¼š</p>
<ul>
<li>åªèƒ½å¼ºå¼•ç”¨æ”¾å…¥é›†åˆä¸­çš„å¯¹è±¡</li>
<li>å¦‚æœæƒ³è¦å¼±å¼•ç”¨ï¼Œåªèƒ½é€šè¿‡NSValueåŒ…è£…</li>
<li>ä¸èƒ½æ”¾å…¥nil</li>
</ul>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="comment">/// NSValueçš„è¿™ä¸ªæ–¹æ³•å¯ä»¥ä¿æŒå¯¹å¯¹è±¡çš„å¼±å¼•ç”¨</span></span><br><span class="line">+ (<span class="type">NSValue</span> *)valueWithNonretainedObject:(nullable id)anObject;</span><br></pre></td></tr></table></figure>

<p>è€Œæ–°å¢çš„è¿™ä¸‰ç§é›†åˆï¼Œè§£å†³äº†ä»¥ä¸Šé—®é¢˜ï¼Œä»–ä»¬éƒ½ä½¿ç”¨äº†NSPointerFunctionsOptionså’ŒNSPointerFunctionsæ¥å†³å®šå†…å­˜ç®¡ç†ç­‰æ–¹å¼ï¼Œå…ˆæ¥çœ‹ä¸‹å®ƒä»¬ï¼š</p>
<p><strong>NSPointerFunctionsOptions</strong><br>å®ƒæ˜¯CF_OPTIONSç±»å‹çš„ï¼Œç”¨æ³•ä¸CF_ENUMç±»ä¼¼ï¼Œä¸€å…±åˆ†ä¸ºä¸‰ç±»ï¼š</p>
<ul>
<li>å†…å­˜ç®¡ç†æ–¹å¼</li>
<li>å¯¹è±¡åˆ¤ç­‰æ–¹å¼</li>
<li>å†…å­˜æ ‡è¯†æ–¹å¼</li>
</ul>
<p>ä¾‹å¦‚ï¼šéœ€è¦å¼±å¼•ç”¨æˆå‘˜ã€ä½¿ç”¨å¯¹è±¡æ–¹å¼å¯¹æ¯”ã€å¹¶ä¸” add æ—¶ copy å¯¹è±¡ï¼Œåˆ™å¯ä»¥è¿™ä¹ˆå†™ï¼š</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="type">NSPointerFunctionsOptions</span> *options = <span class="type">NSPointerFunctionsWeakMemory</span> | <span class="type">NSPointerFunctionsObjectPersonality</span> | <span class="type">NSPointerFunctionsCopyIn</span>;</span><br></pre></td></tr></table></figure>

<p>å…·ä½“ç±»å‹åœ¨æ­¤ä¸å†èµ˜è¿°</p>
<p><strong>NSPointerFunctions</strong><br>æ˜¯è‡ªå®šä¹‰æˆå‘˜çš„å¤„ç†æ–¹å¼ï¼Œå¦‚å†…å­˜ç®¡ç†ã€å¯¹è±¡åˆ¤ç­‰ï¼Œä»–ä»¬éƒ½æ˜¯å‡½æ•°æŒ‡é’ˆï¼Œç”¨æ³•å¦‚ä¸‹</p>
<pre><code class="Swift"><span class="keyword">static</span> <span class="type">BOOL</span> <span class="type">IsEqual</span>(const void *item1, const void *item2, <span class="type">NSUInteger</span> (*size)(const void *item)) {
    <span class="keyword">return</span> *(const int *)item1 == *(const int *)item2;
}

<span class="type">NSPointerFunctions</span> *functions = [[<span class="type">NSPointerFunctions</span> alloc] <span class="keyword">init</span>];
[functions setIsEqualFunction:<span class="type">IsEqual</span>];</code></pre>
<h2 id="1-NSPointerArray"><a href="#1-NSPointerArray" class="headerlink" title="1.NSPointerArray"></a>1.NSPointerArray</h2><p><strong>ç‰¹ç‚¹ï¼š</strong></p>
<ul>
<li>ä¸ NSArray ä¸åŒï¼Œå®ƒå¯ä»¥å­˜å‚¨ NULLï¼Œå¹¶ä¸” NULL è¿˜å‚ä¸ count çš„è®¡ç®—</li>
<li>count å¯ä»¥ setï¼Œå¦‚æœç›´æ¥ set countï¼Œé‚£ä¹ˆä¼šä½¿ç”¨ NULL å ä½</li>
<li>å¯ä»¥ä½¿ç”¨ weak æ¥ä¿®é¥°æˆå‘˜</li>
<li>æˆå‘˜å¯ä»¥æ˜¯æ‰€æœ‰æŒ‡é’ˆç±»å‹ </li>
</ul>
<p><strong>åˆå§‹åŒ–æ–¹æ³•ï¼š</strong></p>
<pre><code class="Swift">- (instancetype)initWithOptions:(<span class="type">NSPointerFunctionsOptions</span>)options;
- (instancetype)initWithPointerFunctions:(<span class="type">NSPointerFunctions</span> *)functions; </code></pre>
<p><strong>compactæ–¹æ³•</strong><br>NSPointerArrayå¯ä»¥æ·»åŠ NULLï¼ŒåŒæ ·APIæä¾›äº†compactæ–¹æ³•ç”¨äºå‰”é™¤æ‰€æœ‰NULL<br>âš ï¸æˆ‘ä»¬ä¸»åŠ¨æ·»åŠ çš„NULLçš„æ—¶å€™ï¼Œä¼šè¢«æ ‡è®°ï¼Œä¹‹åè°ƒç”¨compactçš„æ—¶å€™ï¼Œæ‰€æœ‰NULLä¼šè¢«æ ‡è®°ï¼Œä½†æ˜¯æˆ‘ä»¬ç›´æ¥set countæˆ–è€…æˆå‘˜å·²ç»è¢«é‡Šæ”¾ï¼Œæ­¤æ—¶å¹¶ä¸ä¼šè¢«æ ‡è®°ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨è°ƒç”¨compactä¹‹å‰æ‰‹åŠ¨ç»™æ·»åŠ ä¸€ä¸ªNULLæ¥æ‰“ä¸Šæ ‡è®°ï¼š</p>
<pre><code class="Swift">[array addPointer:<span class="type">NULL</span>];
[array compact];</code></pre>
<h2 id="2-NSMapTable"><a href="#2-NSMapTable" class="headerlink" title="2.NSMapTable"></a>2.NSMapTable</h2><p><strong>ç‰¹ç‚¹ï¼š</strong></p>
<ul>
<li>key å¯ä»¥ä¸ç”¨éµå¾ª NSCopying åè®®</li>
<li>key å’Œ value çš„å†…å­˜ç®¡ç†æ–¹å¼å¯ä»¥åˆ†å¼€ï¼Œå¦‚ï¼škey æ˜¯å¼ºå¼•ç”¨ï¼Œvalue æ˜¯å¼±å¼•ç”¨</li>
<li>å½“ç”¨ weak ä¿®é¥° key æˆ– value æ—¶ï¼Œæœ‰ä¸€æ–¹è¢«é‡Šæ”¾ï¼Œåˆ™è¯¥é”®å€¼å¯¹ç§»é™¤</li>
</ul>
<h2 id="3-NSHashTable"><a href="#3-NSHashTable" class="headerlink" title="3.NSHashTable"></a>3.NSHashTable</h2><p><strong>ç‰¹ç‚¹ï¼š</strong>  </p>
<ul>
<li>ä¸<strong>NSPointerArray</strong>ä¸€æ ·å¯ä»¥æ ¹æ®NSPointerFunctionsOptionsæ¥å†³å®šå¯¹å¯¹è±¡çš„å†…å­˜ç®¡ç†æ–¹å¼</li>
</ul>
<p>æœ€åæ¥ä¸€ä¸ªNSHashTableçš„demoéªŒè¯ä¸€ä¸‹</p>
<pre><code class="Swift"><span class="comment">// demo </span>
int main(int argc, const char * argv[]) {    
    <span class="type">NSHashTable</span> *hashTable = [<span class="type">NSHashTable</span> hashTableWithOptions:<span class="type">NSPointerFunctionsWeakMemory</span>];
    @autoreleasepool {
        <span class="type">NSObject</span> *obj = [[<span class="type">NSObject</span> alloc] <span class="keyword">init</span>];
        [hashTable addObject:obj];
        <span class="type">NSLog</span>(@<span class="string">"before-----%@"</span>, hashTable);
        <span class="type">NSLog</span>(@<span class="string">"before-----%ld"</span>, hashTable.<span class="built_in">count</span>);
    }
    <span class="type">NSLog</span>(@<span class="string">"after-----%@"</span>, hashTable);
    <span class="type">NSLog</span>(@<span class="string">"after-----%ld"</span>, hashTable.<span class="built_in">count</span>);
}   
<span class="comment">// ç»“æœ</span>
...before-----<span class="type">NSHashTable</span> {
...[<span class="number">15</span>] &lt;<span class="type">NSObject</span>: <span class="number">0x10056a6d0</span>&gt;
...}
...before-----<span class="number">1</span>
...after-----<span class="type">NSHashTable</span> {
...} 
...after-----<span class="number">1</span>  <span class="comment">//è™½ç„¶objè¢«é‡Šæ”¾äº†ï¼Œä½†æ˜¯NULLä»ç„¶ä¼šè¢«è®¡æ•°</span></code></pre>
]]></content>
      <categories>
        <category>Objective-C</category>
      </categories>
      <tags>
        <tag>é›†åˆ</tag>
      </tags>
  </entry>
  <entry>
    <title>macOS Catalina 10.15 å®‰è£… CocoaPods æ­¥éª¤</title>
    <url>/2020/03/24/macOS-Catalina-10-15-%E5%AE%89%E8%A3%85-CocoaPods-%E6%AD%A5%E9%AA%A4/</url>
    <content><![CDATA[<!-- toc -->

<h5 id="1-æ£€æŸ¥ç”µè„‘ä¸Šçš„-CocoaPods-ç‰ˆæœ¬"><a href="#1-æ£€æŸ¥ç”µè„‘ä¸Šçš„-CocoaPods-ç‰ˆæœ¬" class="headerlink" title="1. æ£€æŸ¥ç”µè„‘ä¸Šçš„ CocoaPods ç‰ˆæœ¬"></a>1. æ£€æŸ¥ç”µè„‘ä¸Šçš„ CocoaPods ç‰ˆæœ¬</h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">pod --version</span><br></pre></td></tr></table></figure>
<p>è¾“å‡ºï¼šzsh: command not found: pod  å¥½çš„ ä½ æœç„¶æ²¡æœ‰å®‰è£…CocoaPods</p>
<a id="more"></a>

<h5 id="2-çœ‹ä¸‹rubyç‰ˆæœ¬"><a href="#2-çœ‹ä¸‹rubyç‰ˆæœ¬" class="headerlink" title="2. çœ‹ä¸‹rubyç‰ˆæœ¬"></a>2. çœ‹ä¸‹rubyç‰ˆæœ¬</h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ruby -v</span><br></pre></td></tr></table></figure>
<p>è¾“å‡ºï¼šruby 2.6.3p62 (2019-04-16 revision 67580) [universal.x86_64-darwin19]</p>
<h5 id="3-æŸ¥çœ‹å½“å‰å®‰è£…çš„gemæº"><a href="#3-æŸ¥çœ‹å½“å‰å®‰è£…çš„gemæº" class="headerlink" title="3. æŸ¥çœ‹å½“å‰å®‰è£…çš„gemæº"></a>3. æŸ¥çœ‹å½“å‰å®‰è£…çš„gemæº</h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gem sources -l</span><br></pre></td></tr></table></figure>
<p>è¾“å‡ºï¼š<br><strong>* CURRENT SOURCES *</strong><br><a href="https://rubygems.org/" target="_blank" rel="noopener">https://rubygems.org/</a></p>
<h5 id="4-ç§»é™¤åŸæœ‰çš„æº"><a href="#4-ç§»é™¤åŸæœ‰çš„æº" class="headerlink" title="4. ç§»é™¤åŸæœ‰çš„æº"></a>4. ç§»é™¤åŸæœ‰çš„æº</h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gem sources --remove https:&#x2F;&#x2F;rubygems.org&#x2F;</span><br></pre></td></tr></table></figure>

<p>è¾“å‡ºï¼š<a href="https://rubygems.org/" target="_blank" rel="noopener">https://rubygems.org/</a> removed from sources<br>ç§»é™¤æˆåŠŸ</p>
<h5 id="5-æ·»åŠ ruby-chinaçš„æº"><a href="#5-æ·»åŠ ruby-chinaçš„æº" class="headerlink" title="5. æ·»åŠ ruby-chinaçš„æº"></a>5. æ·»åŠ ruby-chinaçš„æº</h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gem sources -a https:&#x2F;&#x2F;gems.ruby-china.com&#x2F;</span><br></pre></td></tr></table></figure>
<p>è¾“å‡ºï¼š<a href="https://gems.ruby-china.com/" target="_blank" rel="noopener">https://gems.ruby-china.com/</a> added to sources<br>æ·»åŠ æˆåŠŸ</p>
<h5 id="6-å®‰è£…"><a href="#6-å®‰è£…" class="headerlink" title="6. å®‰è£…"></a>6. å®‰è£…</h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">sudo gem install cocoapods</span><br></pre></td></tr></table></figure>

<p>è¾“å‡ºç»“æœï¼šâ€¦ 32 gems installed.<br>å®‰è£…å®Œæˆ</p>
]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>CocoaPods</tag>
      </tags>
  </entry>
  <entry>
    <title>Gitå¸¸ç”¨æŒ‡ä»¤</title>
    <url>/2018/03/24/Git%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/</url>
    <content><![CDATA[<!-- TOC -->

<h3 id="ä¸€ã€æ–°å»ºä»“åº“"><a href="#ä¸€ã€æ–°å»ºä»“åº“" class="headerlink" title="ä¸€ã€æ–°å»ºä»“åº“"></a>ä¸€ã€æ–°å»ºä»“åº“</h3><hr>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"># åœ¨å½“å‰ç›®å½•æ–°å»ºä¸€ä¸ª<span class="type">Git</span>ä»“åº“</span><br><span class="line">$ git <span class="keyword">init</span></span><br><span class="line"></span><br><span class="line"># æ–°å»ºä¸€ä¸ªç›®å½•ï¼Œå°†å…¶åˆå§‹åŒ–ä¸º<span class="type">Git</span>ä»“åº“</span><br><span class="line">$ git <span class="keyword">init</span> [project-name]</span><br><span class="line"></span><br><span class="line"># å…‹éš†ä¸€ä¸ªé¡¹ç›®</span><br><span class="line">git clone [url]</span><br></pre></td></tr></table></figure>

<a id="more"></a>

<h3 id="äºŒã€é…ç½®"><a href="#äºŒã€é…ç½®" class="headerlink" title="äºŒã€é…ç½®"></a>äºŒã€é…ç½®</h3><hr>
<p>Gitçš„è®¾ç½®æ–‡ä»¶ä¸º.gitconfigï¼Œå®ƒå¯ä»¥åœ¨ç”¨æˆ·ä¸»ç›®å½•ä¸‹ï¼ˆå…¨å±€é…ç½®ï¼‰ï¼Œä¹Ÿå¯ä»¥åœ¨é¡¹ç›®ç›®å½•ä¸‹ï¼ˆé¡¹ç›®é…ç½®ï¼‰ã€‚</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"># æ˜¾ç¤ºå½“å‰çš„<span class="type">Git</span>é…ç½®</span><br><span class="line">$ git config --list</span><br><span class="line"></span><br><span class="line"># ç¼–è¾‘<span class="type">Git</span>é…ç½®æ–‡ä»¶</span><br><span class="line">$ git config -e [--global]</span><br><span class="line"></span><br><span class="line"># è®¾ç½®æäº¤ä»£ç æ—¶çš„ç”¨æˆ·ä¿¡æ¯</span><br><span class="line">$ git config [--global] user.name <span class="string">"[name]"</span></span><br><span class="line">$ git config [--global] user.email <span class="string">"[email address]"</span></span><br></pre></td></tr></table></figure>

<h3 id="ä¸‰ã€å¢åŠ -åˆ é™¤æ–‡ä»¶"><a href="#ä¸‰ã€å¢åŠ -åˆ é™¤æ–‡ä»¶" class="headerlink" title="ä¸‰ã€å¢åŠ /åˆ é™¤æ–‡ä»¶"></a>ä¸‰ã€å¢åŠ /åˆ é™¤æ–‡ä»¶</h3><hr>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"># æ·»åŠ æŒ‡å®šæ–‡ä»¶åˆ°æš‚å­˜åŒº</span><br><span class="line">$ git add [file1] [file2] ...</span><br><span class="line"></span><br><span class="line"># æ·»åŠ æŒ‡å®šç›®å½•åˆ°æš‚å­˜åŒºï¼ˆåŒ…æ‹¬å­ç›®å½•ï¼‰</span><br><span class="line">$ git add [dir]</span><br><span class="line"></span><br><span class="line"># æ·»åŠ å½“å‰ç›®å½•çš„æ‰€æœ‰æ–‡ä»¶åˆ°æš‚å­˜åŒº</span><br><span class="line">$ git add .</span><br><span class="line"></span><br><span class="line"># æ·»åŠ æ¯ä¸ªå˜åŒ–å‰ï¼Œéƒ½ä¼šè¦æ±‚ç¡®è®¤</span><br><span class="line"># å¯¹äºåŒä¸€ä¸ªæ–‡ä»¶çš„å¤šå¤„å˜åŒ–ï¼Œå¯ä»¥å®ç°åˆ†æ¬¡æäº¤</span><br><span class="line">$ git add -p</span><br><span class="line"></span><br><span class="line"># åˆ é™¤å·¥ä½œåŒºæ–‡ä»¶ï¼Œå¹¶ä¸”å°†è¿™æ¬¡åˆ é™¤æ”¾å…¥æš‚å­˜åŒº</span><br><span class="line">$ git rm [file1] [file2] ...</span><br><span class="line"></span><br><span class="line"># åœæ­¢è¿½è¸ªæŒ‡å®šæ–‡ä»¶ï¼Œä½†è¯¥æ–‡ä»¶ä¼šä¿ç•™åœ¨å·¥ä½œåŒº</span><br><span class="line">$ git rm --cached [file]</span><br><span class="line"></span><br><span class="line"># æ”¹åæ–‡ä»¶ï¼Œå¹¶ä¸”å°†è¿™ä¸ªæ”¹åæ”¾å…¥æš‚å­˜åŒº</span><br><span class="line">$ git mv [file-original] [file-renamed]</span><br></pre></td></tr></table></figure>

<h3 id="å››ã€ä»£ç æäº¤"><a href="#å››ã€ä»£ç æäº¤" class="headerlink" title="å››ã€ä»£ç æäº¤"></a>å››ã€ä»£ç æäº¤</h3><hr>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"># æäº¤æš‚å­˜åŒºåˆ°ä»“åº“åŒº</span><br><span class="line">$ git commit -m [message]</span><br><span class="line"></span><br><span class="line"># æäº¤æš‚å­˜åŒºçš„æŒ‡å®šæ–‡ä»¶åˆ°ä»“åº“åŒº</span><br><span class="line">$ git commit [file1] [file2] ... -m [message]</span><br><span class="line"></span><br><span class="line"># æäº¤å·¥ä½œåŒºè‡ªä¸Šæ¬¡commitä¹‹åçš„å˜åŒ–ï¼Œç›´æ¥åˆ°ä»“åº“åŒº</span><br><span class="line">$ git commit -a</span><br><span class="line"></span><br><span class="line"># æäº¤æ—¶æ˜¾ç¤ºæ‰€æœ‰çš„diffä¿¡æ¯</span><br><span class="line">$ git commit -v</span><br><span class="line"></span><br><span class="line"># ä½¿ç”¨ä¸€æ¬¡æ–°çš„commitï¼Œæ›¿ä»£ä¸Šä¸€æ¬¡æäº¤</span><br><span class="line"># å¦‚æœä»£ç æ²¡æœ‰ä»»ä½•æ–°å˜åŒ–ï¼Œåˆ™ç”¨æ¥æ”¹å†™ä¸Šä¸€æ¬¡commitçš„æäº¤ä¿¡æ¯</span><br><span class="line">$ git commit --amend -m [message]</span><br><span class="line"></span><br><span class="line"># é‡åšä¸Šä¸€æ¬¡commitï¼Œå¹¶åŒ…æ‹¬æŒ‡å®šæ–‡ä»¶çš„æ–°å˜åŒ–</span><br><span class="line">$ git commit --amend [file1] [file2] ...</span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line">### äº”ã€åˆ†æ”¯</span><br><span class="line">---</span><br><span class="line">```<span class="type">Swift</span></span><br><span class="line"># æŸ¥çœ‹æœ¬åœ°åˆ†æ”¯åˆ—è¡¨</span><br><span class="line">$ git branch</span><br><span class="line"></span><br><span class="line"># æŸ¥çœ‹è¿œç¨‹åˆ†æ”¯åˆ—è¡¨</span><br><span class="line">$ git branch -r</span><br><span class="line"></span><br><span class="line"># åˆ›å»ºä¸€ä¸ªæ–°çš„feature-jxåˆ†æ”¯å¹¶è·Ÿè¸ªoriginçš„è¿œç¨‹developåˆ†æ”¯ (-bè¡¨ç¤ºåˆ‡æ¢åˆ°æ–°å»ºåˆ†æ”¯)</span><br><span class="line">$ git checkout -b feature-jx origin/develop</span><br><span class="line"></span><br><span class="line"># å°†æœ¬åœ°çš„feature-jxåˆ†æ”¯æ¨é€åˆ°è¿œç¨‹featureåˆ†æ”¯ï¼ˆè¿œç¨‹åˆ†æ”¯ä¸å­˜åœ¨åˆ™ä¼šåˆ›å»ºï¼‰</span><br><span class="line">$ git push origin feature-jx:feature</span><br><span class="line"></span><br><span class="line"># æœ¬åœ°åˆ†æ”¯è¿½è¸ªè¿œç¨‹åˆ†æ”¯</span><br><span class="line">$ git branch --<span class="keyword">set</span>-upstream [branch] [remote-branch]</span><br><span class="line"></span><br><span class="line"># åˆå¹¶æŒ‡å®šåˆ†æ”¯åˆ°å½“å‰åˆ†æ”¯</span><br><span class="line">$ git merge [branch]</span><br><span class="line"></span><br><span class="line"># é€‰æ‹©ä¸€ä¸ªcommitï¼Œåˆå¹¶è¿›å½“å‰åˆ†æ”¯</span><br><span class="line">$ git cherry-pick [commit]</span><br><span class="line"></span><br><span class="line"># åˆ é™¤åˆ†æ”¯</span><br><span class="line">$ git branch -d [branch]</span><br><span class="line"></span><br><span class="line"># åˆ é™¤è¿œç¨‹åˆ†æ”¯</span><br><span class="line">$ git push origin --delete [branch]</span><br><span class="line">$ git branch -dr [remote/branch]</span><br><span class="line"></span><br><span class="line"># æ–°å»ºä¸€ä¸ªåˆ†æ”¯ï¼ŒæŒ‡å‘æŒ‡å®šcommit</span><br><span class="line">$ git branch [branch] [commit]</span><br><span class="line"></span><br><span class="line"># æ–°å»ºä¸€ä¸ªåˆ†æ”¯ï¼Œä¸æŒ‡å®šçš„è¿œç¨‹åˆ†æ”¯å»ºç«‹è¿½è¸ªå…³ç³»</span><br><span class="line">$ git branch --track [branch] [remote-branch] </span><br><span class="line"></span><br><span class="line"># åŒæ­¥è¿œç¨‹ä»“åº“åˆ é™¤çŠ¶æ€</span><br><span class="line">$ git remote prune origin</span><br></pre></td></tr></table></figure>

<h3 id="å…­ã€æ ‡ç­¾"><a href="#å…­ã€æ ‡ç­¾" class="headerlink" title="å…­ã€æ ‡ç­¾"></a>å…­ã€æ ‡ç­¾</h3><hr>
<figure class="highlight objc"><table><tr><td class="code"><pre><span class="line"># åˆ—å‡ºæ‰€æœ‰tag </span><br><span class="line">$ git tag</span><br><span class="line"></span><br><span class="line"># æ–°å»ºä¸€ä¸ªtagåœ¨å½“å‰çš„commit</span><br><span class="line">$ git tag [tag]</span><br><span class="line"></span><br><span class="line"># æ–°å»ºä¸€ä¸ªtagåœ¨æŒ‡å®šçš„commit </span><br><span class="line">$ git tag [tag] [commit]</span><br><span class="line"></span><br><span class="line"># åˆ é™¤æœ¬åœ°tag</span><br><span class="line">$ git tag -d [tag]</span><br><span class="line"></span><br><span class="line"># åˆ é™¤è¿œç¨‹tag(æ¨ä¸€ä¸ªç©ºçš„åˆ°å¯¹åº”çš„tag)</span><br><span class="line">$ git push origin :refs/tags/[tagName]</span><br><span class="line"></span><br><span class="line"># æŸ¥çœ‹tagä¿¡æ¯</span><br><span class="line">$ git show [tag]</span><br><span class="line"></span><br><span class="line"># æäº¤æŒ‡å®štag</span><br><span class="line">$ git push [remote] [tag]</span><br><span class="line"></span><br><span class="line"># æäº¤æ‰€æœ‰tag</span><br><span class="line">$ git push [remote] --tags</span><br><span class="line"></span><br><span class="line"># æ–°å»ºä¸€ä¸ªåˆ†æ”¯ï¼ŒæŒ‡å‘æŸä¸ªtag</span><br><span class="line">$ git checkout -b [brach] [tag]</span><br></pre></td></tr></table></figure>

<h3 id="ä¸ƒã€æŸ¥çœ‹ä¿¡æ¯"><a href="#ä¸ƒã€æŸ¥çœ‹ä¿¡æ¯" class="headerlink" title="ä¸ƒã€æŸ¥çœ‹ä¿¡æ¯"></a>ä¸ƒã€æŸ¥çœ‹ä¿¡æ¯</h3><hr>
<figure class="highlight objc"><table><tr><td class="code"><pre><span class="line"># æ˜¾ç¤ºæœ‰å˜æ›´çš„æ–‡ä»¶</span><br><span class="line">$ git status</span><br><span class="line"></span><br><span class="line"># æ˜¾ç¤ºå½“å‰åˆ†æ”¯çš„ç‰ˆæœ¬å†å²</span><br><span class="line">$ git log</span><br><span class="line"></span><br><span class="line"># æ˜¾ç¤ºcommitå†å²ï¼Œä»¥åŠæ¯æ¬¡commitå‘ç”Ÿå˜æ›´çš„æ–‡ä»¶</span><br><span class="line">$ git log --stat</span><br><span class="line"></span><br><span class="line"># æœç´¢æäº¤å†å²ï¼Œæ ¹æ®å…³é”®è¯</span><br><span class="line">$ git log -S [keyword]</span><br><span class="line"></span><br><span class="line"># æ˜¾ç¤ºæŸä¸ªcommitä¹‹åçš„æ‰€æœ‰å˜åŠ¨ï¼Œæ¯ä¸ªcommitå æ®ä¸€è¡Œ</span><br><span class="line">$ git log [tag] HEAD --pretty=format:%s</span><br><span class="line"></span><br><span class="line"># æ˜¾ç¤ºæŸä¸ªcommitä¹‹åçš„æ‰€æœ‰å˜åŠ¨ï¼Œå…¶<span class="string">"æäº¤è¯´æ˜"</span>å¿…é¡»ç¬¦åˆæœç´¢æ¡ä»¶</span><br><span class="line">$ git log [tag] HEAD --grep feature</span><br><span class="line"></span><br><span class="line"># æ˜¾ç¤ºæŸä¸ªæ–‡ä»¶çš„ç‰ˆæœ¬å†å²ï¼ŒåŒ…æ‹¬æ–‡ä»¶æ”¹å</span><br><span class="line">$ git log --follow [file]</span><br><span class="line">$ git whatchanged [file]</span><br><span class="line"></span><br><span class="line"># æ˜¾ç¤ºæŒ‡å®šæ–‡ä»¶ç›¸å…³çš„æ¯ä¸€æ¬¡diff</span><br><span class="line">$ git log -p [file]</span><br><span class="line"></span><br><span class="line"># æ˜¾ç¤ºè¿‡å»<span class="number">5</span>æ¬¡æäº¤</span><br><span class="line">$ git log <span class="number">-5</span> --pretty --oneline</span><br><span class="line"></span><br><span class="line"># æ˜¾ç¤ºæ‰€æœ‰æäº¤è¿‡çš„ç”¨æˆ·ï¼ŒæŒ‰æäº¤æ¬¡æ•°æ’åº</span><br><span class="line">$ git shortlog -sn</span><br><span class="line"></span><br><span class="line"># æ˜¾ç¤ºæŒ‡å®šæ–‡ä»¶æ˜¯ä»€ä¹ˆäººåœ¨ä»€ä¹ˆæ—¶é—´ä¿®æ”¹è¿‡</span><br><span class="line">$ git blame [file]</span><br><span class="line"></span><br><span class="line"># æ˜¾ç¤ºæš‚å­˜åŒºå’Œå·¥ä½œåŒºçš„å·®å¼‚</span><br><span class="line">$ git diff</span><br><span class="line"></span><br><span class="line"># æ˜¾ç¤ºæš‚å­˜åŒºå’Œä¸Šä¸€ä¸ªcommitçš„å·®å¼‚</span><br><span class="line">$ git diff --cached [file]</span><br><span class="line"></span><br><span class="line"># æ˜¾ç¤ºå·¥ä½œåŒºä¸å½“å‰åˆ†æ”¯æœ€æ–°commitä¹‹é—´çš„å·®å¼‚</span><br><span class="line">$ git diff HEAD</span><br><span class="line"></span><br><span class="line"># æ˜¾ç¤ºä¸¤æ¬¡æäº¤ä¹‹é—´çš„å·®å¼‚</span><br><span class="line">$ git diff [first-branch]...[second-branch]</span><br><span class="line"></span><br><span class="line"># æ˜¾ç¤ºä»Šå¤©ä½ å†™äº†å¤šå°‘è¡Œä»£ç </span><br><span class="line">$ git diff --shortstat <span class="string">"@&#123;0 day ago&#125;"</span></span><br><span class="line"></span><br><span class="line"># æ˜¾ç¤ºæŸæ¬¡æäº¤çš„å…ƒæ•°æ®å’Œå†…å®¹å˜åŒ–</span><br><span class="line">$ git show [commit]</span><br><span class="line"></span><br><span class="line"># æ˜¾ç¤ºæŸæ¬¡æäº¤å‘ç”Ÿå˜åŒ–çš„æ–‡ä»¶</span><br><span class="line">$ git show --name-only [commit]</span><br><span class="line"></span><br><span class="line"># æ˜¾ç¤ºæŸæ¬¡æäº¤æ—¶ï¼ŒæŸä¸ªæ–‡ä»¶çš„å†…å®¹</span><br><span class="line">$ git show [commit]:[filename]</span><br><span class="line"></span><br><span class="line"># æ˜¾ç¤ºå½“å‰åˆ†æ”¯çš„æœ€è¿‘å‡ æ¬¡æäº¤</span><br><span class="line">$ git reflog</span><br></pre></td></tr></table></figure>

<h3 id="å…«ã€è¿œç¨‹åŒæ­¥"><a href="#å…«ã€è¿œç¨‹åŒæ­¥" class="headerlink" title="å…«ã€è¿œç¨‹åŒæ­¥"></a>å…«ã€è¿œç¨‹åŒæ­¥</h3><hr>
<figure class="highlight objc"><table><tr><td class="code"><pre><span class="line"># ä¸‹è½½è¿œç¨‹ä»“åº“çš„æ‰€æœ‰å˜åŠ¨</span><br><span class="line">$ git fetch [remote]</span><br><span class="line"></span><br><span class="line"># æ˜¾ç¤ºæ‰€æœ‰è¿œç¨‹ä»“åº“</span><br><span class="line">$ git remote -v</span><br><span class="line"></span><br><span class="line"># æ˜¾ç¤ºæŸä¸ªè¿œç¨‹ä»“åº“çš„ä¿¡æ¯</span><br><span class="line">$ git remote show [remote]</span><br><span class="line"></span><br><span class="line"># å¢åŠ ä¸€ä¸ªæ–°çš„è¿œç¨‹ä»“åº“ï¼Œå¹¶å‘½å</span><br><span class="line">$ git remote add [shortname] [url]</span><br><span class="line"></span><br><span class="line"># å–å›è¿œç¨‹ä»“åº“çš„å˜åŒ–ï¼Œå¹¶ä¸æœ¬åœ°åˆ†æ”¯åˆå¹¶</span><br><span class="line">$ git pull [remote] [branch]</span><br><span class="line"></span><br><span class="line"># ä¸Šä¼ æœ¬åœ°æŒ‡å®šåˆ†æ”¯åˆ°è¿œç¨‹ä»“åº“</span><br><span class="line">$ git push [remote] [branch]</span><br><span class="line"></span><br><span class="line"># å¼ºè¡Œæ¨é€å½“å‰åˆ†æ”¯åˆ°è¿œç¨‹ä»“åº“ï¼Œå³ä½¿æœ‰å†²çª</span><br><span class="line">$ git push [remote] --force</span><br><span class="line"></span><br><span class="line"># æ¨é€æ‰€æœ‰åˆ†æ”¯åˆ°è¿œç¨‹ä»“åº“</span><br><span class="line">$ git push [remote] --all</span><br><span class="line"></span><br><span class="line"># åŒæ­¥è¿œç¨‹åˆ†æ”¯ï¼ˆå¯ä»¥ç”¨æ¥åˆ é™¤æœ¬åœ°ä¸å­˜åœ¨çš„è¿œç¨‹åˆ†æ”¯ï¼‰</span><br><span class="line">$ git pull -p</span><br><span class="line"># ç­‰åŒäºğŸ‘‡</span><br><span class="line">$ git fetch -p</span><br><span class="line">$ git fetch --prune origin</span><br></pre></td></tr></table></figure>

<h3 id="ä¹ã€æ’¤é”€"><a href="#ä¹ã€æ’¤é”€" class="headerlink" title="ä¹ã€æ’¤é”€"></a>ä¹ã€æ’¤é”€</h3><hr>
<figure class="highlight objc"><table><tr><td class="code"><pre><span class="line"># æ¢å¤æš‚å­˜åŒºçš„æŒ‡å®šæ–‡ä»¶åˆ°å·¥ä½œåŒº</span><br><span class="line">$ git checkout [file]</span><br><span class="line"></span><br><span class="line"># æ¢å¤æŸä¸ªcommitçš„æŒ‡å®šæ–‡ä»¶åˆ°æš‚å­˜åŒºå’Œå·¥ä½œåŒº</span><br><span class="line">$ git checkout [commit] [file]</span><br><span class="line"></span><br><span class="line"># æ¢å¤æš‚å­˜åŒºçš„æ‰€æœ‰æ–‡ä»¶åˆ°å·¥ä½œåŒº</span><br><span class="line">$ git checkout .</span><br><span class="line"></span><br><span class="line"># é‡ç½®æš‚å­˜åŒºçš„æŒ‡å®šæ–‡ä»¶ï¼Œä¸ä¸Šä¸€æ¬¡commitä¿æŒä¸€è‡´ï¼Œä½†å·¥ä½œåŒºä¸å˜</span><br><span class="line">$ git reset [file]</span><br><span class="line"></span><br><span class="line"># é‡ç½®æš‚å­˜åŒºä¸å·¥ä½œåŒºï¼Œä¸ä¸Šä¸€æ¬¡commitä¿æŒä¸€è‡´</span><br><span class="line">$ git reset --hard</span><br><span class="line"></span><br><span class="line"># é‡ç½®å½“å‰åˆ†æ”¯çš„æŒ‡é’ˆä¸ºæŒ‡å®šcommitï¼ŒåŒæ—¶é‡ç½®æš‚å­˜åŒºï¼Œä½†å·¥ä½œåŒºä¸å˜</span><br><span class="line">$ git reset [commit]</span><br><span class="line"></span><br><span class="line"># é‡ç½®å½“å‰åˆ†æ”¯çš„HEADä¸ºæŒ‡å®šcommitï¼ŒåŒæ—¶é‡ç½®æš‚å­˜åŒºå’Œå·¥ä½œåŒºï¼Œä¸æŒ‡å®šcommitä¸€è‡´</span><br><span class="line">$ git reset --hard [commit]</span><br><span class="line"></span><br><span class="line"># é‡ç½®å½“å‰HEADä¸ºæŒ‡å®šcommitï¼Œä½†ä¿æŒæš‚å­˜åŒºå’Œå·¥ä½œåŒºä¸å˜</span><br><span class="line">$ git reset --keep [commit]</span><br><span class="line"></span><br><span class="line"># æ–°å»ºä¸€ä¸ªcommitï¼Œç”¨æ¥æ’¤é”€æŒ‡å®šcommit</span><br><span class="line"># åè€…çš„æ‰€æœ‰å˜åŒ–éƒ½å°†è¢«å‰è€…æŠµæ¶ˆï¼Œå¹¶ä¸”åº”ç”¨åˆ°å½“å‰åˆ†æ”¯</span><br><span class="line">$ git revert [commit]</span><br><span class="line"></span><br><span class="line"># æš‚æ—¶å°†æœªæäº¤çš„å˜åŒ–ç§»é™¤ï¼Œç¨åå†ç§»å…¥</span><br><span class="line">$ git stash</span><br><span class="line">$ git stash pop</span><br></pre></td></tr></table></figure>

<h3 id="åã€å…¶ä»–"><a href="#åã€å…¶ä»–" class="headerlink" title="åã€å…¶ä»–"></a>åã€å…¶ä»–</h3><hr>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"># ç”Ÿæˆä¸€ä¸ªå¯ä¾›å‘å¸ƒçš„å‹ç¼©åŒ…</span><br><span class="line">$ git archive</span><br></pre></td></tr></table></figure>

<h3 id="ä¸€ã€æ’¤é”€å½“å‰commitï¼Œå¹¶å°†æ”¹åŠ¨æ¢å¤åˆ°ç¼“å­˜åŒº"><a href="#ä¸€ã€æ’¤é”€å½“å‰commitï¼Œå¹¶å°†æ”¹åŠ¨æ¢å¤åˆ°ç¼“å­˜åŒº" class="headerlink" title="ä¸€ã€æ’¤é”€å½“å‰commitï¼Œå¹¶å°†æ”¹åŠ¨æ¢å¤åˆ°ç¼“å­˜åŒº"></a>ä¸€ã€æ’¤é”€å½“å‰commitï¼Œå¹¶å°†æ”¹åŠ¨æ¢å¤åˆ°ç¼“å­˜åŒº</h3><hr>
<pre><code class="Swift"># <span class="number">1</span>.å…ˆæŸ¥çœ‹å†å²æäº¤è®°å½•ï¼š
$ git log --pretty=oneline

# <span class="number">2</span>.å›é€€åˆ°ä¸Šæ¬¡æäº¤ï¼Œå¹¶ä¸”ä¿ç•™ä¿®æ”¹(**hardå°†ä¼šä¸¢å¼ƒæ›´æ”¹!**) 
$ git reset --soft 319c879dc5ff2d18d71164523c2009da6bcf2011

# <span class="number">3</span>.æš‚å­˜ä¿®æ”¹
$ git  stash

# <span class="number">4</span>.åˆ‡æ¢åˆ†æ”¯
$ git checkout -b åˆ†æ”¯å

# <span class="number">5</span>.æŸ¥çœ‹æ‰€æœ‰çš„è´®è—ï¼ˆåªæœ‰ä¸€ä¸ªè´®è— å¯ä»¥ä½¿ç”¨ git stash pop æ¢å¤ï¼‰
$ git stash list</code></pre>
]]></content>
      <categories>
        <category>Tools</category>
      </categories>
      <tags>
        <tag>Git</tag>
      </tags>
  </entry>
  <entry>
    <title>å•ä¾‹blockå¼•å‘çš„æ€è€ƒ</title>
    <url>/2018/03/24/%E5%8D%95%E4%BE%8Bblock%E5%BC%95%E5%8F%91%E7%9A%84%E6%80%9D%E8%80%83/</url>
    <content><![CDATA[<!-- toc -->

<p>AFNetworking æ¡†æ¶ä¸­çš„ AFNetworkReachabilityManager å¯ä»¥ç”¨æ¥ç›‘å¬ç½‘ç»œçŠ¶æ€çš„å˜åŒ–ï¼Œç»å¸¸è¿™æ ·ä½¿ç”¨ï¼š</p>
<a id="more"></a>

<figure class="highlight objc"><table><tr><td class="code"><pre><span class="line">[[AFNetworkReachabilityManager sharedManager] setReachabilityStatusChangeBlock:^(AFNetworkReachabilityStatus status) &#123;</span><br><span class="line">    <span class="comment">// code...</span></span><br><span class="line">&#125;];</span><br></pre></td></tr></table></figure>

<p>æŸ¥çœ‹æºç ï¼Œä¼šå‘ç° setReachabilityStatusChangeBlock æ–¹æ³•åªæ˜¯å•çº¯çš„å°† block èµ‹å€¼ç»™äº†ä¸€ä¸ªæ™®é€šå˜é‡ï¼Œè¿™è¯´æ˜ block æœ‰è¢«è¦†ç›–çš„é£é™©ã€‚</p>
<h2 id="æ€è€ƒï¼šå¦‚ä½•é¿å…å•ä¾‹çš„blockè¢«è¦†ç›–"><a href="#æ€è€ƒï¼šå¦‚ä½•é¿å…å•ä¾‹çš„blockè¢«è¦†ç›–" class="headerlink" title="æ€è€ƒï¼šå¦‚ä½•é¿å…å•ä¾‹çš„blockè¢«è¦†ç›–"></a>æ€è€ƒï¼šå¦‚ä½•é¿å…å•ä¾‹çš„blockè¢«è¦†ç›–</h2><p>AFNetworking çš„ issue ä¸­ä¹Ÿæœ‰äººæå‡ºç›¸åŒçš„é—®é¢˜ï¼Œç›®å‰æœ‰2ç§è§£å†³æ–¹æ¡ˆï¼š</p>
<figure class="highlight objc"><table><tr><td class="code"><pre><span class="line">åœ¨blockçš„å›è°ƒä¸­å‘é€šçŸ¥</span><br><span class="line">AFNetworking3<span class="number">.0</span> ä½œè€…æ–°å¢äº†ä¸€ä¸ª manager ç±»æ–¹æ³•ï¼Œå¯ä»¥åˆ›å»ºä¸€ä¸ªæ–°çš„ AFNetworkReachabilityManager å¯¹è±¡ï¼Œè¿™æ ·å°±ä¸ä¼šé€ æˆblockè¢«è¦†ç›–äº†</span><br></pre></td></tr></table></figure>

<p>ä¸ä½¿ç”¨ä¸Šé¢2ç§åŠæ³•ï¼Œæœ‰æ²¡æœ‰åˆ«çš„æ–¹æ³•å¯ä»¥é¿å…blockè¢«è¦†ç›–å‘¢ï¼Ÿ</p>
<h2 id="é›†åˆ"><a href="#é›†åˆ" class="headerlink" title="é›†åˆ"></a>é›†åˆ</h2><p><strong>blockè¢«è¦†ç›–çš„åŸå› ï¼šå•ä¾‹ + ä½¿ç”¨æ™®é€šå¯¹è±¡æ¥æ”¶block</strong><br>é‚£ä¹ˆå¯ä»¥é€‰æ‹©ç”¨é›†åˆæ¥æ¥æ”¶blockï¼Œé€‰æ‹©é›†åˆéœ€è¦è€ƒè™‘2ç‚¹ï¼š</p>
<ul>
<li>1ã€æœ‰åº/æ— åº</li>
<li>2ã€strong/weak</li>
</ul>
<p>æ­¤å¤„ä½¿ç”¨æœ‰åºé›†åˆè²Œä¼¼æ²¡ä»€ä¹ˆç”¨ï¼Œä½¿ç”¨ strong çš„è¯ä¹Ÿå°±æ˜¯ NSMutableDictionary ï¼Œé‚£ä¹ˆä¼šå¼•å…¥ä¸€ä¸ªæ–°çš„é—®é¢˜ï¼šä½•æ—¶é‡Šæ”¾ block å‘¢ï¼Ÿé‚£ä¹ˆå¯ä»¥ä½¿ç”¨ NSMapTable ï¼Ÿå°† key è®¾ç½®ä¸º NSPointerFunctionsWeakMemory ï¼Œé‚£ä¹ˆå°±ä¸ç”¨æˆ‘ä»¬æ‰‹åŠ¨å»é‡Šæ”¾äº†</p>
<figure class="highlight objc"><table><tr><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)addNetworkStatusCallback:(dispatch_block_t)callback &#123;</span><br><span class="line">    [<span class="keyword">self</span>.table setObject:callback forKey:<span class="string">@"UUID"</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>ä½†æ˜¯ç”±äºkeyæ˜¯å±€éƒ¨å˜é‡ï¼Œæ‰€ä»¥å‡ºäº†æ–¹æ³•åblockä»ç„¶ä¼šè¢«é‡Šæ”¾ï¼Œæ‰€ä»¥å¾—æ€è€ƒåˆ°åº•ç”±è°æ¥æŒæœ‰blockã€‚</li>
<li>æ ¹æ®è®¾è®¡åŸåˆ™ï¼šè°æ³¨å†Œå›è°ƒå°±ç”±è°æ¥ç®¡ç†blockï¼Œå•ä¾‹ä»…ä»…åªç»´æŠ¤ ç®¡ç†è€… ä¸ block çš„æ˜ å°„å…³ç³»ã€‚ </li>
</ul>
<h2 id="Associated-Object"><a href="#Associated-Object" class="headerlink" title="Associated Object"></a>Associated Object</h2><p>é€šè¿‡å…³è”å¯¹è±¡æŠ€æœ¯å°† callback ç»‘å®šç»™ observerï¼Œè€Œå•ä¾‹çš„ NSMapTable ä¸­ï¼Œkey å’Œ value éƒ½æ˜¯ weakï¼Œä»…éœ€è¦ç»´æŠ¤ observer ä¸ callback çš„æ˜ å°„å…³ç³»å³å¯ï¼Œç»“æ„å¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &lt;viewController&gt;: &lt;callback&gt;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å•ä¾‹ä¸­å®ç°ç›¸åº”æ–¹æ³•ï¼š</p>
<figure class="highlight objc"><table><tr><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)addObserver:(<span class="keyword">id</span>)observer callback:(dispatch_block_t)callback &#123;</span><br><span class="line">    [<span class="keyword">self</span>.table setObject:callback forKey:observer];</span><br><span class="line">    <span class="built_in">NSString</span> *key = [[<span class="built_in">NSString</span> stringWithFormat:<span class="string">@"%p"</span>, &amp;observer] UTF8String];</span><br><span class="line">    objc_setAssociatedObject(observer, key, callback, OBJC_ASSOCIATION_COPY_NONATOMIC);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åœ¨ viewController ä¸­å¯ä»¥è¿™æ ·ä½¿ç”¨ ï¼š</p>
<figure class="highlight objc"><table><tr><td class="code"><pre><span class="line">[[ObserverSingleton shareInstance] addObserver:<span class="keyword">self</span> callback:^&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"status callback"</span>);</span><br><span class="line">&#125;];</span><br></pre></td></tr></table></figure>

<p>ç§»é™¤æ“ä½œ</p>
<figure class="highlight objc"><table><tr><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)removeObserver:(<span class="keyword">id</span>)observer &#123;</span><br><span class="line">    [<span class="keyword">self</span>.table removeObjectForKey:observer];</span><br><span class="line">    <span class="built_in">NSString</span> *key = [[<span class="built_in">NSString</span> stringWithFormat:<span class="string">@"%p"</span>, &amp;observer] UTF8String];</span><br><span class="line">    objc_setAssociatedObject(observer, key, <span class="literal">nil</span>, OBJC_ASSOCIATION_COPY_NONATOMIC);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å…¶å®è¿™æ ·å¤„ç†æœ‰ä¸€ä¸ªå¼Šç«¯ï¼šä½¿ç”¨è€…å¾ˆå®¹æ˜“è§‰å¾— self ä¸ callback æ²¡æœ‰å¼•ç”¨å…³ç³»ï¼Œå®é™…ä¸Šå¾—ä½¿ç”¨weakSelf æ‰èƒ½é¿å…å¾ªç¯å¼•ç”¨ã€‚</p>
]]></content>
      <categories>
        <category>Objective-C</category>
      </categories>
      <tags>
        <tag>block</tag>
      </tags>
  </entry>
  <entry>
    <title>ç»™UIViewæ·»åŠ é˜´å½±çš„æ­£ç¡®æ–¹å¼</title>
    <url>/2016/04/21/%E7%BB%99UIView%E6%B7%BB%E5%8A%A0%E9%98%B4%E5%BD%B1%E7%9A%84%E6%AD%A3%E7%A1%AE%E6%96%B9%E5%BC%8F/</url>
    <content><![CDATA[<!-- toc -->

<h2 id="1-çº¯ä»£ç "><a href="#1-çº¯ä»£ç " class="headerlink" title="1.çº¯ä»£ç "></a>1.çº¯ä»£ç </h2><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="comment">/// åŸºæœ¬è®¾ç½® </span></span><br><span class="line"><span class="type">CALayer</span> *layer = [view layer];</span><br><span class="line"><span class="comment">/// é˜´å½±åŠå¾„ï¼Œé»˜è®¤ä¸º3.</span></span><br><span class="line">layer.shadowRadius = <span class="number">5.0</span>;</span><br><span class="line"><span class="comment">/// é˜´å½±åç§»é‡ï¼Œé»˜è®¤ä¸º(0, -3).</span></span><br><span class="line"><span class="comment">/// xå³ã€yä¸‹ã€-xå·¦ã€-yä¸Šã€(0, 0)ä¸ºå››è¾¹éƒ½æœ‰é˜´å½±.</span></span><br><span class="line">layer.shadowOffset = <span class="type">CGSizeMake</span>(<span class="number">0</span>, <span class="number">3</span>);</span><br><span class="line"><span class="comment">/// é˜´å½±é¢œè‰²ï¼Œé»˜è®¤ä¸ºé»‘è‰².</span></span><br><span class="line">layer.shadowColor = [<span class="type">UIColor</span> blackColor].<span class="type">CGColor</span>;</span><br><span class="line"><span class="comment">/// é˜´å½±é€æ˜åº¦ï¼Œé»˜è®¤ä¸º0.</span></span><br><span class="line">layer.shadowOpacity = <span class="number">0.5</span>; </span><br><span class="line"><span class="comment">/// ç”¨äºæ„é€ å±‚é˜´å½±çš„è½®å»“ï¼Œèƒ½å¤Ÿæé«˜æ€§èƒ½</span></span><br><span class="line">view.layer.shadowPath = [[<span class="type">UIBezierPath</span> bezierPathWithRect:view.bounds] <span class="type">CGPath</span>];</span><br></pre></td></tr></table></figure>

<a id="more"></a>

<ul>
<li>å½“æ²¡æœ‰è®¾ç½®<code>layer.shadowPath</code>çš„æ—¶å€™ï¼Œå¯ä»¥é€šè¿‡æ‰“å¼€<br><code>Xcode---&gt;Debug---&gt;View Debugging---&gt;Rendering---&gt;Color Offscreen-Rendered Yellow</code><br>æŸ¥çœ‹åˆ°å½“å‰è®¾ç½®é˜´å½±çš„viewæœ‰ä¸€å±‚é»„è‰²è’™æ¿ï¼Œä¹Ÿå°±æ˜¯å½“å‰viewå·²ç»äº§ç”Ÿç¦»å±æ¸²æŸ“äº† </li>
<li>è®¾ç½®äº†<code>layer.shadowPath</code>åï¼Œæ€§èƒ½æœ‰æ‰€æé«˜ï¼Œå»ºè®®ä½¿ç”¨</li>
</ul>
<h2 id="2-xib"><a href="#2-xib" class="headerlink" title="2.xib"></a>2.xib</h2><p>å¯ä»¥åˆ©ç”¨Runtimeå’ŒKVCåœ¨xibä¸­è®¾ç½®ç›¸å…³å±æ€§<br>é€‰ä¸­xibæ–‡ä»¶ä¸­çš„viewï¼Œå³ä¾§å¯ä»¥è®¾ç½®ï¼š<br><img src="https://i.loli.net/2020/06/22/LFKY9R8jbzoxIrP.png" alt="xib config.png"></p>
<p>âš ï¸ä¸Šå›¾ä¸­å·²ç»å°†shadowColoræ›¿æ¢æˆäº†è‡ªå®šä¹‰çš„shadowUIColorï¼Œå› ä¸ºè¿™é‡Œåªèƒ½è®¾ç½®UIColorè€Œä¸æ˜¯CGColorRefï¼ŒåŒç†borderColorä¹Ÿæ˜¯å¦‚æ­¤</p>
<p>ä¸ºCALayeræ·»åŠ Categoryï¼Œæ–°å¢2ä¸ªå±æ€§è§£å†³ä¸Šé¢çš„é—®é¢˜</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="comment">/// CALayer+Extension.h</span></span><br><span class="line">@interface <span class="type">CALayer</span> (<span class="type">Extension</span>)</span><br><span class="line"><span class="comment">/// è‡ªå®šä¹‰å±æ€§ï¼šè¾¹æ¡†é¢œè‰²</span></span><br><span class="line">@property (nonatomic, strong) <span class="type">UIColor</span> *borderUIColor;</span><br><span class="line"><span class="comment">/// è‡ªå®šä¹‰å±æ€§ï¼šé˜´å½±é¢œè‰²</span></span><br><span class="line">@property (nonatomic, strong) <span class="type">UIColor</span> *shadowUIColor;</span><br><span class="line"></span><br><span class="line">@end</span><br><span class="line"></span><br><span class="line"><span class="comment">/// CALayer+Extension.m é‡å†™Setterå’ŒGetter</span></span><br><span class="line">@implementation <span class="type">CALayer</span> (<span class="type">Extension</span>)</span><br><span class="line"></span><br><span class="line">- (void)setBorderUIColor:(<span class="type">UIColor</span> *)borderUIColor &#123;</span><br><span class="line">    <span class="keyword">self</span>.borderColor = borderUIColor.<span class="type">CGColor</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="type">UIColor</span> *)borderUIColor &#123;</span><br><span class="line">    <span class="keyword">return</span> [<span class="type">UIColor</span> colorWithCGColor:<span class="keyword">self</span>.borderColor];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)setShadowUIColor:(<span class="type">UIColor</span> *)shadowUIColor &#123;</span><br><span class="line">    <span class="keyword">self</span>.shadowColor = shadowUIColor.<span class="type">CGColor</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="type">UIColor</span> *)shadowUIColor &#123;</span><br><span class="line">    <span class="keyword">return</span> [<span class="type">UIColor</span> colorWithCGColor:<span class="keyword">self</span>.shadowColor];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@end</span><br></pre></td></tr></table></figure>

<p>try try?</p>
<figure class="highlight objc"><table><tr><td class="code"><pre><span class="line">layer.shadowColor = [<span class="built_in">UIColor</span> colorWithWhite:<span class="number">0</span> alpha:<span class="number">0.2</span>].CGColor;</span><br><span class="line">layer.shadowOffset = <span class="built_in">CGSizeMake</span>(<span class="number">0</span>,<span class="number">0</span>);</span><br><span class="line">layer.shadowOpacity = <span class="number">1.0</span>f;</span><br><span class="line">layer.shadowRadius  = <span class="number">12</span>;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>CALayer</tag>
      </tags>
  </entry>
</search>
